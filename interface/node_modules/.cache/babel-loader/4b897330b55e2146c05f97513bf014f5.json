{"ast":null,"code":"import _asyncToGenerator from\"/home/brent/Downloads/esp8266-react/interface/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/brent/Downloads/esp8266-react/interface/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/home/brent/Downloads/esp8266-react/interface/node_modules/@babel/runtime/regenerator/index.js\";import{useCallback,useEffect,useState}from'react';import axios from'axios';import{useSnackbar}from\"notistack\";import{extractErrorMessage}from'../../utils';var useFileUpload=function useFileUpload(_ref){var upload=_ref.upload;var _useSnackbar=useSnackbar(),enqueueSnackbar=_useSnackbar.enqueueSnackbar;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),uploading=_useState2[0],setUploading=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),uploadProgress=_useState4[0],setUploadProgress=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),uploadCancelToken=_useState6[0],setUploadCancelToken=_useState6[1];var resetUploadingStates=function resetUploadingStates(){setUploading(false);setUploadProgress(undefined);setUploadCancelToken(undefined);};var cancelUpload=useCallback(function(){uploadCancelToken===null||uploadCancelToken===void 0?void 0:uploadCancelToken.cancel();resetUploadingStates();},[uploadCancelToken]);useEffect(function(){return function(){uploadCancelToken===null||uploadCancelToken===void 0?void 0:uploadCancelToken.cancel();};},[uploadCancelToken]);var uploadFile=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(images){var cancelToken;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;cancelToken=axios.CancelToken.source();setUploadCancelToken(cancelToken);setUploading(true);_context.next=6;return upload(images[0],{onUploadProgress:setUploadProgress,cancelToken:cancelToken.token});case 6:resetUploadingStates();enqueueSnackbar('Upload successful',{variant:'success'});_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);if(axios.isCancel(_context.t0)){enqueueSnackbar('Upload aborted',{variant:'warning'});}else{resetUploadingStates();enqueueSnackbar(extractErrorMessage(_context.t0,'Upload failed'),{variant:'error'});}case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return function uploadFile(_x){return _ref2.apply(this,arguments);};}();return[uploadFile,cancelUpload,uploading,uploadProgress];};export default useFileUpload;","map":null,"metadata":{},"sourceType":"module"}