{"ast":null,"code":"import _toConsumableArray from\"/home/brent/Documents/PlatformIO/Projects/ESP32_C3_Test/interface/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import Schema from\"async-validator\";export var SECURITY_SETTINGS_VALIDATOR=new Schema({jwt_secret:[{required:true,message:\"JWT secret is required\"},{type:\"string\",min:1,max:64,message:\"JWT secret must be between 1 and 64 characters\"}]});export var createUserValidator=function createUserValidator(users,creating){return new Schema({username:[{required:true,message:\"Username is required\"},{type:\"string\",pattern:/^[a-zA-Z0-9_\\\\.]{1,24}$/,message:\"Must be 1-24 characters: alpha numeric, '_' or '.'\"}].concat(_toConsumableArray(creating?[createUniqueUsernameValidator(users)]:[])),password:[{required:true,message:\"Please provide a password\"},{type:\"string\",min:1,max:64,message:\"Password must be 1-64 characters\"}]});};export var createUniqueUsernameValidator=function createUniqueUsernameValidator(users){return{validator:function validator(rule,username,callback){if(username&&users.find(function(u){return u.username===username;})){callback(\"Username already in use\");}else{callback();}}};};","map":{"version":3,"sources":["/home/brent/Documents/PlatformIO/Projects/ESP32_C3_Test/interface/src/validators/security.ts"],"names":["Schema","SECURITY_SETTINGS_VALIDATOR","jwt_secret","required","message","type","min","max","createUserValidator","users","creating","username","pattern","createUniqueUsernameValidator","password","validator","rule","callback","find","u"],"mappings":"+JAAA,MAAOA,CAAAA,MAAP,KAAyC,iBAAzC,CAIA,MAAO,IAAMC,CAAAA,2BAA2B,CAAG,GAAID,CAAAA,MAAJ,CAAW,CACpDE,UAAU,CAAE,CACV,CAAEC,QAAQ,CAAE,IAAZ,CAAkBC,OAAO,CAAE,wBAA3B,CADU,CAEV,CAAEC,IAAI,CAAE,QAAR,CAAkBC,GAAG,CAAE,CAAvB,CAA0BC,GAAG,CAAE,EAA/B,CAAmCH,OAAO,CAAE,gDAA5C,CAFU,CADwC,CAAX,CAApC,CAOP,MAAO,IAAMI,CAAAA,mBAAmB,CAAG,QAAtBA,CAAAA,mBAAsB,CAACC,KAAD,CAAgBC,QAAhB,QAAsC,IAAIV,CAAAA,MAAJ,CAAW,CAClFW,QAAQ,EACN,CAAER,QAAQ,CAAE,IAAZ,CAAkBC,OAAO,CAAE,sBAA3B,CADM,CAEN,CAAEC,IAAI,CAAE,QAAR,CAAkBO,OAAO,CAAE,yBAA3B,CAAsDR,OAAO,CAAE,oDAA/D,CAFM,4BAGFM,QAAQ,CAAG,CAACG,6BAA6B,CAACJ,KAAD,CAA9B,CAAH,CAA4C,EAHlD,EAD0E,CAMlFK,QAAQ,CAAE,CACR,CAAEX,QAAQ,CAAE,IAAZ,CAAkBC,OAAO,CAAE,2BAA3B,CADQ,CAER,CAAEC,IAAI,CAAE,QAAR,CAAkBC,GAAG,CAAE,CAAvB,CAA0BC,GAAG,CAAE,EAA/B,CAAmCH,OAAO,CAAE,kCAA5C,CAFQ,CANwE,CAAX,CAAtC,EAA5B,CAYP,MAAO,IAAMS,CAAAA,6BAA6B,CAAG,QAAhCA,CAAAA,6BAAgC,CAACJ,KAAD,QAAoB,CAC/DM,SAD+D,oBACrDC,IADqD,CAC7BL,QAD6B,CACXM,QADW,CACyB,CACtF,GAAIN,QAAQ,EAAIF,KAAK,CAACS,IAAN,CAAW,SAACC,CAAD,QAAOA,CAAAA,CAAC,CAACR,QAAF,GAAeA,QAAtB,EAAX,CAAhB,CAA4D,CAC1DM,QAAQ,CAAC,yBAAD,CAAR,CACD,CAFD,IAEO,CACLA,QAAQ,GACT,CACF,CAP8D,CAApB,EAAtC","sourcesContent":["import Schema, { InternalRuleItem } from \"async-validator\";\n\nimport { User } from \"../types\";\n\nexport const SECURITY_SETTINGS_VALIDATOR = new Schema({\n  jwt_secret: [\n    { required: true, message: \"JWT secret is required\" },\n    { type: \"string\", min: 1, max: 64, message: \"JWT secret must be between 1 and 64 characters\" }\n  ]\n});\n\nexport const createUserValidator = (users: User[], creating: boolean) => new Schema({\n  username: [\n    { required: true, message: \"Username is required\" },\n    { type: \"string\", pattern: /^[a-zA-Z0-9_\\\\.]{1,24}$/, message: \"Must be 1-24 characters: alpha numeric, '_' or '.'\" },\n    ...(creating ? [createUniqueUsernameValidator(users)] : [])\n  ],\n  password: [\n    { required: true, message: \"Please provide a password\" },\n    { type: \"string\", min: 1, max: 64, message: \"Password must be 1-64 characters\" }\n  ],\n});\n\nexport const createUniqueUsernameValidator = (users: User[]) => ({\n  validator(rule: InternalRuleItem, username: string, callback: (error?: string) => void) {\n    if (username && users.find((u) => u.username === username)) {\n      callback(\"Username already in use\");\n    } else {\n      callback();\n    }\n  }\n});\n\n"]},"metadata":{},"sourceType":"module"}