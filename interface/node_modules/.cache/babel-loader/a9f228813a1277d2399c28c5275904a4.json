{"ast":null,"code":"import{useCallback,useContext,useEffect}from'react';import{Navigate,Routes,Route,useNavigate,useLocation}from'react-router-dom';import{FeaturesContext}from'./contexts/features';import*as AuthenticationApi from'./api/authentication';import{PROJECT_PATH}from'./api/env';import{AXIOS}from'./api/endpoints';import{Layout,RequireAdmin}from'./components';import ProjectRouting from'./project/ProjectRouting';import WiFiConnection from'./framework/wifi/WiFiConnection';import AccessPoint from'./framework/ap/AccessPoint';import NetworkTime from'./framework/ntp/NetworkTime';import Mqtt from'./framework/mqtt/Mqtt';import System from'./framework/system/System';import Security from'./framework/security/Security';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AuthenticatedRouting=function AuthenticatedRouting(){var _useContext=useContext(FeaturesContext),features=_useContext.features;var location=useLocation();var navigate=useNavigate();var handleApiResponseError=useCallback(function(error){if(error.response&&error.response.status===401){AuthenticationApi.storeLoginRedirect(location);navigate(\"/unauthorized\");}return Promise.reject(error);},[location,navigate]);useEffect(function(){var axiosHandlerId=AXIOS.interceptors.response.use(function(response){return response;},handleApiResponseError);return function(){return AXIOS.interceptors.response.eject(axiosHandlerId);};},[handleApiResponseError]);return/*#__PURE__*/_jsx(Layout,{children:/*#__PURE__*/_jsxs(Routes,{children:[features.project&&/*#__PURE__*/_jsx(Route,{path:\"/\".concat(PROJECT_PATH,\"/*\"),element:/*#__PURE__*/_jsx(ProjectRouting,{})}),/*#__PURE__*/_jsx(Route,{path:\"/wifi/*\",element:/*#__PURE__*/_jsx(WiFiConnection,{})}),/*#__PURE__*/_jsx(Route,{path:\"/ap/*\",element:/*#__PURE__*/_jsx(AccessPoint,{})}),features.ntp&&/*#__PURE__*/_jsx(Route,{path:\"/ntp/*\",element:/*#__PURE__*/_jsx(NetworkTime,{})}),features.mqtt&&/*#__PURE__*/_jsx(Route,{path:\"/mqtt/*\",element:/*#__PURE__*/_jsx(Mqtt,{})}),features.security&&/*#__PURE__*/_jsx(Route,{path:\"/security/*\",element:/*#__PURE__*/_jsx(RequireAdmin,{children:/*#__PURE__*/_jsx(Security,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/system/*\",element:/*#__PURE__*/_jsx(System,{})}),/*#__PURE__*/_jsx(Route,{path:\"/*\",element:/*#__PURE__*/_jsx(Navigate,{to:AuthenticationApi.getDefaultRoute(features)})})]})});};export default AuthenticatedRouting;","map":{"version":3,"sources":["/home/brent/Documents/PlatformIO/Projects/ESP32_C3_Test/interface/src/AuthenticatedRouting.tsx"],"names":["useCallback","useContext","useEffect","Navigate","Routes","Route","useNavigate","useLocation","FeaturesContext","AuthenticationApi","PROJECT_PATH","AXIOS","Layout","RequireAdmin","ProjectRouting","WiFiConnection","AccessPoint","NetworkTime","Mqtt","System","Security","AuthenticatedRouting","features","location","navigate","handleApiResponseError","error","response","status","storeLoginRedirect","Promise","reject","axiosHandlerId","interceptors","use","eject","project","ntp","mqtt","security","getDefaultRoute"],"mappings":"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","sourcesContent":["import { FC, useCallback, useContext, useEffect } from 'react';\nimport { Navigate, Routes, Route, useNavigate, useLocation } from 'react-router-dom';\nimport { AxiosError } from 'axios';\n\nimport { FeaturesContext } from './contexts/features';\nimport * as AuthenticationApi from './api/authentication';\nimport { PROJECT_PATH } from './api/env';\nimport { AXIOS } from './api/endpoints';\nimport { Layout, RequireAdmin } from './components';\n\nimport ProjectRouting from './project/ProjectRouting';\n\nimport WiFiConnection from './framework/wifi/WiFiConnection';\nimport AccessPoint from './framework/ap/AccessPoint';\nimport NetworkTime from './framework/ntp/NetworkTime';\nimport Mqtt from './framework/mqtt/Mqtt';\nimport System from './framework/system/System';\nimport Security from './framework/security/Security';\n\nconst AuthenticatedRouting: FC = () => {\n  const { features } = useContext(FeaturesContext);\n  const location = useLocation();\n  const navigate = useNavigate();\n\n  const handleApiResponseError = useCallback((error: AxiosError) => {\n    if (error.response && error.response.status === 401) {\n      AuthenticationApi.storeLoginRedirect(location);\n      navigate(\"/unauthorized\");\n    }\n    return Promise.reject(error);\n  }, [location, navigate]);\n\n  useEffect(() => {\n    const axiosHandlerId = AXIOS.interceptors.response.use((response) => response, handleApiResponseError);\n    return () => AXIOS.interceptors.response.eject(axiosHandlerId);\n  }, [handleApiResponseError]);\n\n  return (\n    <Layout>\n      <Routes>\n        {features.project && (\n          <Route path={`/${PROJECT_PATH}/*`} element={<ProjectRouting />} />\n        )}\n        <Route path=\"/wifi/*\" element={<WiFiConnection />} />\n        <Route path=\"/ap/*\" element={<AccessPoint />} />\n        {features.ntp && (\n          <Route path=\"/ntp/*\" element={<NetworkTime />} />\n        )}\n        {features.mqtt && (\n          <Route path=\"/mqtt/*\" element={<Mqtt />} />\n        )}\n        {features.security && (\n          <Route\n            path=\"/security/*\"\n            element={\n              <RequireAdmin>\n                <Security />\n              </RequireAdmin>\n            }\n          />\n        )}\n        <Route path=\"/system/*\" element={<System />} />\n        <Route path=\"/*\" element={<Navigate to={AuthenticationApi.getDefaultRoute(features)} />} />\n      </Routes>\n    </Layout>\n  );\n};\n\nexport default AuthenticatedRouting;\n"]},"metadata":{},"sourceType":"module"}