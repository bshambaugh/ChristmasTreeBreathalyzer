{"ast":null,"code":"import _asyncToGenerator from\"/home/brent/Documents/PlatformIO/Projects/ESP32_C3_Test/interface/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/brent/Documents/PlatformIO/Projects/ESP32_C3_Test/interface/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/home/brent/Documents/PlatformIO/Projects/ESP32_C3_Test/interface/node_modules/@babel/runtime/regenerator/index.js\";import{useCallback,useEffect,useState}from'react';import*as FeaturesApi from'../../api/features';import{extractErrorMessage}from'../../utils';import{ApplicationError,LoadingSpinner}from'../../components';import{FeaturesContext}from'.';import{jsx as _jsx}from\"react/jsx-runtime\";var FeaturesLoader=function FeaturesLoader(props){var _useState=useState(),_useState2=_slicedToArray(_useState,2),errorMessage=_useState2[0],setErrorMessage=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),features=_useState4[0],setFeatures=_useState4[1];var loadFeatures=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return FeaturesApi.readFeatures();case 3:response=_context.sent;setFeatures(response.data);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);setErrorMessage(extractErrorMessage(_context.t0,'Failed to fetch application details.'));case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);})),[]);useEffect(function(){loadFeatures();},[loadFeatures]);if(features){return/*#__PURE__*/_jsx(FeaturesContext.Provider,{value:{features:features},children:props.children});}if(errorMessage){return/*#__PURE__*/_jsx(ApplicationError,{message:errorMessage});}return/*#__PURE__*/_jsx(LoadingSpinner,{height:\"100vh\"});};export default FeaturesLoader;","map":{"version":3,"sources":["/home/brent/Documents/PlatformIO/Projects/ESP32_C3_Test/interface/src/contexts/features/FeaturesLoader.tsx"],"names":["useCallback","useEffect","useState","FeaturesApi","extractErrorMessage","ApplicationError","LoadingSpinner","FeaturesContext","FeaturesLoader","props","errorMessage","setErrorMessage","features","setFeatures","loadFeatures","readFeatures","response","data","children"],"mappings":"wcAAA,OAAaA,WAAb,CAA0BC,SAA1B,CAAqCC,QAArC,KAAqD,OAArD,CAEA,MAAO,GAAKC,CAAAA,WAAZ,KAA6B,oBAA7B,CAEA,OAASC,mBAAT,KAA2D,aAA3D,CAEA,OAAQC,gBAAR,CAA0BC,cAA1B,KAA+C,kBAA/C,CAEA,OAASC,eAAT,KAAgC,GAAhC,C,2CAEA,GAAMC,CAAAA,cAAyC,CAAG,QAA5CA,CAAAA,cAA4C,CAACC,KAAD,CAAW,CAE3D,cAAwCP,QAAQ,EAAhD,wCAAOQ,YAAP,eAAqBC,eAArB,eACA,eAAgCT,QAAQ,EAAxC,yCAAOU,QAAP,eAAiBC,WAAjB,eAEA,GAAMC,CAAAA,YAAY,CAAGd,WAAW,sEAAC,sLAENG,CAAAA,WAAW,CAACY,YAAZ,EAFM,QAEvBC,QAFuB,eAG7BH,WAAW,CAACG,QAAQ,CAACC,IAAV,CAAX,CAH6B,+EAK7BN,eAAe,CAACP,mBAAmB,aAAQ,sCAAR,CAApB,CAAf,CAL6B,oEAAD,GAO7B,EAP6B,CAAhC,CASAH,SAAS,CAAC,UAAM,CACda,YAAY,GACb,CAFQ,CAEN,CAACA,YAAD,CAFM,CAAT,CAIA,GAAIF,QAAJ,CAAc,CACZ,mBACE,KAAC,eAAD,CAAiB,QAAjB,EACE,KAAK,CAAE,CACLA,QAAQ,CAARA,QADK,CADT,UAKGH,KAAK,CAACS,QALT,EADF,CASD,CAED,GAAIR,YAAJ,CAAkB,CAChB,mBACE,KAAC,gBAAD,EAAkB,OAAO,CAAEA,YAA3B,EADF,CAGD,CAED,mBACE,KAAC,cAAD,EAAgB,MAAM,CAAC,OAAvB,EADF,CAID,CAxCD,CA0CA,cAAeF,CAAAA,cAAf","sourcesContent":["import { FC, useCallback, useEffect, useState } from 'react';\n\nimport * as FeaturesApi from '../../api/features';\n\nimport { extractErrorMessage, RequiredChildrenProps } from '../../utils';\nimport { Features } from '../../types';\nimport {ApplicationError, LoadingSpinner} from '../../components';\n\nimport { FeaturesContext } from '.';\n\nconst FeaturesLoader: FC<RequiredChildrenProps> = (props) => {\n\n  const [errorMessage, setErrorMessage] = useState<string>();\n  const [features, setFeatures] = useState<Features>();\n\n  const loadFeatures = useCallback(async () => {\n    try {\n      const response = await FeaturesApi.readFeatures();\n      setFeatures(response.data);\n    } catch (error: any) {\n      setErrorMessage(extractErrorMessage(error, 'Failed to fetch application details.'));\n    }\n  }, []);\n\n  useEffect(() => {\n    loadFeatures();\n  }, [loadFeatures]);\n\n  if (features) {\n    return (\n      <FeaturesContext.Provider\n        value={{\n          features\n        }}\n      >\n        {props.children}\n      </FeaturesContext.Provider>\n    );\n  }\n\n  if (errorMessage) {\n    return (\n      <ApplicationError message={errorMessage} />\n    );\n  }\n\n  return (\n    <LoadingSpinner height=\"100vh\" />\n  );\n\n};\n\nexport default FeaturesLoader;\n"]},"metadata":{},"sourceType":"module"}