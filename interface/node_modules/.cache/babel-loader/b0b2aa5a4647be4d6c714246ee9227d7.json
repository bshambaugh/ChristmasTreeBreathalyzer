{"ast":null,"code":"function noop() {}\n\nexport default function (url, opts) {\n  opts = opts || {};\n  var ws,\n      num = 0,\n      timer = 1,\n      $ = {};\n  var max = opts.maxAttempts || Infinity;\n\n  $.open = function () {\n    ws = new WebSocket(url, opts.protocols || []);\n    ws.onmessage = opts.onmessage || noop;\n\n    ws.onopen = function (e) {\n      (opts.onopen || noop)(e);\n      num = 0;\n    };\n\n    ws.onclose = function (e) {\n      e.code === 1e3 || e.code === 1001 || e.code === 1005 || $.reconnect(e);\n      (opts.onclose || noop)(e);\n    };\n\n    ws.onerror = function (e) {\n      e && e.code === 'ECONNREFUSED' ? $.reconnect(e) : (opts.onerror || noop)(e);\n    };\n  };\n\n  $.reconnect = function (e) {\n    if (timer && num++ < max) {\n      timer = setTimeout(function () {\n        (opts.onreconnect || noop)(e);\n        $.open();\n      }, opts.timeout || 1e3);\n    } else {\n      (opts.onmaximum || noop)(e);\n    }\n  };\n\n  $.json = function (x) {\n    ws.send(JSON.stringify(x));\n  };\n\n  $.send = function (x) {\n    ws.send(x);\n  };\n\n  $.close = function (x, y) {\n    timer = clearTimeout(timer);\n    ws.close(x || 1e3, y);\n  };\n\n  $.open(); // init\n\n  return $;\n}","map":{"version":3,"sources":["/home/brent/Documents/PlatformIO/Projects/ESP32_C3_Test/interface/node_modules/sockette/dist/sockette.mjs"],"names":["noop","url","opts","ws","num","timer","$","max","maxAttempts","Infinity","open","WebSocket","protocols","onmessage","onopen","e","onclose","code","reconnect","onerror","setTimeout","onreconnect","timeout","onmaximum","json","x","send","JSON","stringify","close","y","clearTimeout"],"mappings":"AAAA,SAASA,IAAT,GAAgB,CAAE;;AAElB,eAAe,UAAUC,GAAV,EAAeC,IAAf,EAAqB;AACnCA,EAAAA,IAAI,GAAGA,IAAI,IAAI,EAAf;AAEA,MAAIC,EAAJ;AAAA,MAAQC,GAAG,GAAC,CAAZ;AAAA,MAAeC,KAAK,GAAC,CAArB;AAAA,MAAwBC,CAAC,GAAC,EAA1B;AACA,MAAIC,GAAG,GAAGL,IAAI,CAACM,WAAL,IAAoBC,QAA9B;;AAEAH,EAAAA,CAAC,CAACI,IAAF,GAAS,YAAY;AACpBP,IAAAA,EAAE,GAAG,IAAIQ,SAAJ,CAAcV,GAAd,EAAmBC,IAAI,CAACU,SAAL,IAAkB,EAArC,CAAL;AAEAT,IAAAA,EAAE,CAACU,SAAH,GAAeX,IAAI,CAACW,SAAL,IAAkBb,IAAjC;;AAEAG,IAAAA,EAAE,CAACW,MAAH,GAAY,UAAUC,CAAV,EAAa;AACxB,OAACb,IAAI,CAACY,MAAL,IAAed,IAAhB,EAAsBe,CAAtB;AACAX,MAAAA,GAAG,GAAG,CAAN;AACA,KAHD;;AAKAD,IAAAA,EAAE,CAACa,OAAH,GAAa,UAAUD,CAAV,EAAa;AACzBA,MAAAA,CAAC,CAACE,IAAF,KAAW,GAAX,IAAkBF,CAAC,CAACE,IAAF,KAAW,IAA7B,IAAqCF,CAAC,CAACE,IAAF,KAAW,IAAhD,IAAwDX,CAAC,CAACY,SAAF,CAAYH,CAAZ,CAAxD;AACA,OAACb,IAAI,CAACc,OAAL,IAAgBhB,IAAjB,EAAuBe,CAAvB;AACA,KAHD;;AAKAZ,IAAAA,EAAE,CAACgB,OAAH,GAAa,UAAUJ,CAAV,EAAa;AACxBA,MAAAA,CAAC,IAAIA,CAAC,CAACE,IAAF,KAAS,cAAf,GAAiCX,CAAC,CAACY,SAAF,CAAYH,CAAZ,CAAjC,GAAkD,CAACb,IAAI,CAACiB,OAAL,IAAgBnB,IAAjB,EAAuBe,CAAvB,CAAlD;AACA,KAFD;AAGA,GAlBD;;AAoBAT,EAAAA,CAAC,CAACY,SAAF,GAAc,UAAUH,CAAV,EAAa;AAC1B,QAAIV,KAAK,IAAID,GAAG,KAAKG,GAArB,EAA0B;AACzBF,MAAAA,KAAK,GAAGe,UAAU,CAAC,YAAY;AAC9B,SAAClB,IAAI,CAACmB,WAAL,IAAoBrB,IAArB,EAA2Be,CAA3B;AACAT,QAAAA,CAAC,CAACI,IAAF;AACA,OAHiB,EAGfR,IAAI,CAACoB,OAAL,IAAgB,GAHD,CAAlB;AAIA,KALD,MAKO;AACN,OAACpB,IAAI,CAACqB,SAAL,IAAkBvB,IAAnB,EAAyBe,CAAzB;AACA;AACD,GATD;;AAWAT,EAAAA,CAAC,CAACkB,IAAF,GAAS,UAAUC,CAAV,EAAa;AACrBtB,IAAAA,EAAE,CAACuB,IAAH,CAAQC,IAAI,CAACC,SAAL,CAAeH,CAAf,CAAR;AACA,GAFD;;AAIAnB,EAAAA,CAAC,CAACoB,IAAF,GAAS,UAAUD,CAAV,EAAa;AACrBtB,IAAAA,EAAE,CAACuB,IAAH,CAAQD,CAAR;AACA,GAFD;;AAIAnB,EAAAA,CAAC,CAACuB,KAAF,GAAU,UAAUJ,CAAV,EAAaK,CAAb,EAAgB;AACzBzB,IAAAA,KAAK,GAAG0B,YAAY,CAAC1B,KAAD,CAApB;AACAF,IAAAA,EAAE,CAAC0B,KAAH,CAASJ,CAAC,IAAI,GAAd,EAAmBK,CAAnB;AACA,GAHD;;AAKAxB,EAAAA,CAAC,CAACI,IAAF,GAlDmC,CAkDzB;;AAEV,SAAOJ,CAAP;AACA","sourcesContent":["function noop() {}\n\nexport default function (url, opts) {\n\topts = opts || {};\n\n\tvar ws, num=0, timer=1, $={};\n\tvar max = opts.maxAttempts || Infinity;\n\n\t$.open = function () {\n\t\tws = new WebSocket(url, opts.protocols || []);\n\n\t\tws.onmessage = opts.onmessage || noop;\n\n\t\tws.onopen = function (e) {\n\t\t\t(opts.onopen || noop)(e);\n\t\t\tnum = 0;\n\t\t};\n\n\t\tws.onclose = function (e) {\n\t\t\te.code === 1e3 || e.code === 1001 || e.code === 1005 || $.reconnect(e);\n\t\t\t(opts.onclose || noop)(e);\n\t\t};\n\n\t\tws.onerror = function (e) {\n\t\t\t(e && e.code==='ECONNREFUSED') ? $.reconnect(e) : (opts.onerror || noop)(e);\n\t\t};\n\t};\n\n\t$.reconnect = function (e) {\n\t\tif (timer && num++ < max) {\n\t\t\ttimer = setTimeout(function () {\n\t\t\t\t(opts.onreconnect || noop)(e);\n\t\t\t\t$.open();\n\t\t\t}, opts.timeout || 1e3);\n\t\t} else {\n\t\t\t(opts.onmaximum || noop)(e);\n\t\t}\n\t};\n\n\t$.json = function (x) {\n\t\tws.send(JSON.stringify(x));\n\t};\n\n\t$.send = function (x) {\n\t\tws.send(x);\n\t};\n\n\t$.close = function (x, y) {\n\t\ttimer = clearTimeout(timer);\n\t\tws.close(x || 1e3, y);\n\t};\n\n\t$.open(); // init\n\n\treturn $;\n}\n"]},"metadata":{},"sourceType":"module"}