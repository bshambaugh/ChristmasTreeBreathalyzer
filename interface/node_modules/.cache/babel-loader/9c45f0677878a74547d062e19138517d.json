{"ast":null,"code":"import{Avatar,Button,Divider,List,ListItem,ListItemAvatar,ListItemText,useTheme}from\"@mui/material\";import DeviceHubIcon from'@mui/icons-material/DeviceHub';import RefreshIcon from'@mui/icons-material/Refresh';import ReportIcon from'@mui/icons-material/Report';import*as MqttApi from\"../../api/mqtt\";import{MqttDisconnectReason}from\"../../types\";import{ButtonRow,FormLoader,SectionContent}from\"../../components\";import{useRest}from\"../../utils\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export var mqttStatusHighlight=function mqttStatusHighlight(_ref,theme){var enabled=_ref.enabled,connected=_ref.connected;if(!enabled){return theme.palette.info.main;}if(connected){return theme.palette.success.main;}return theme.palette.error.main;};export var mqttStatus=function mqttStatus(_ref2){var enabled=_ref2.enabled,connected=_ref2.connected;if(!enabled){return\"Not enabled\";}if(connected){return\"Connected\";}return\"Disconnected\";};export var disconnectReason=function disconnectReason(_ref3){var disconnect_reason=_ref3.disconnect_reason;switch(disconnect_reason){case MqttDisconnectReason.TCP_DISCONNECTED:return\"TCP disconnected\";case MqttDisconnectReason.MQTT_UNACCEPTABLE_PROTOCOL_VERSION:return\"Unacceptable protocol version\";case MqttDisconnectReason.MQTT_IDENTIFIER_REJECTED:return\"Client ID rejected\";case MqttDisconnectReason.MQTT_SERVER_UNAVAILABLE:return\"Server unavailable\";case MqttDisconnectReason.MQTT_MALFORMED_CREDENTIALS:return\"Malformed credentials\";case MqttDisconnectReason.MQTT_NOT_AUTHORIZED:return\"Not authorized\";case MqttDisconnectReason.ESP8266_NOT_ENOUGH_SPACE:return\"Device out of memory\";case MqttDisconnectReason.TLS_BAD_FINGERPRINT:return\"Server fingerprint invalid\";default:return\"Unknown\";}};var MqttStatusForm=function MqttStatusForm(){var _useRest=useRest({read:MqttApi.readMqttStatus}),loadData=_useRest.loadData,data=_useRest.data,errorMessage=_useRest.errorMessage;var theme=useTheme();var content=function content(){if(!data){return/*#__PURE__*/_jsx(FormLoader,{onRetry:loadData,errorMessage:errorMessage});}var renderConnectionStatus=function renderConnectionStatus(){if(data.connected){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(ListItem,{children:[/*#__PURE__*/_jsx(ListItemAvatar,{children:/*#__PURE__*/_jsx(Avatar,{children:\"#\"})}),/*#__PURE__*/_jsx(ListItemText,{primary:\"Client ID\",secondary:data.client_id})]}),/*#__PURE__*/_jsx(Divider,{variant:\"inset\",component:\"li\"})]});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(ListItem,{children:[/*#__PURE__*/_jsx(ListItemAvatar,{children:/*#__PURE__*/_jsx(Avatar,{children:/*#__PURE__*/_jsx(ReportIcon,{})})}),/*#__PURE__*/_jsx(ListItemText,{primary:\"Disconnect Reason\",secondary:disconnectReason(data)})]}),/*#__PURE__*/_jsx(Divider,{variant:\"inset\",component:\"li\"})]});};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(List,{children:[/*#__PURE__*/_jsxs(ListItem,{children:[/*#__PURE__*/_jsx(ListItemAvatar,{children:/*#__PURE__*/_jsx(Avatar,{sx:{bgcolor:mqttStatusHighlight(data,theme)},children:/*#__PURE__*/_jsx(DeviceHubIcon,{})})}),/*#__PURE__*/_jsx(ListItemText,{primary:\"Status\",secondary:mqttStatus(data)})]}),/*#__PURE__*/_jsx(Divider,{variant:\"inset\",component:\"li\"}),data.enabled&&renderConnectionStatus()]}),/*#__PURE__*/_jsx(ButtonRow,{pt:1,children:/*#__PURE__*/_jsx(Button,{startIcon:/*#__PURE__*/_jsx(RefreshIcon,{}),variant:\"contained\",color:\"secondary\",onClick:loadData,children:\"Refresh\"})})]});};return/*#__PURE__*/_jsx(SectionContent,{title:\"MQTT Status\",titleGutter:true,children:content()});};export default MqttStatusForm;","map":{"version":3,"sources":["/home/brent/Documents/PlatformIO/Projects/ESP32_C3_Test/interface/src/framework/mqtt/MqttStatusForm.tsx"],"names":["Avatar","Button","Divider","List","ListItem","ListItemAvatar","ListItemText","useTheme","DeviceHubIcon","RefreshIcon","ReportIcon","MqttApi","MqttDisconnectReason","ButtonRow","FormLoader","SectionContent","useRest","mqttStatusHighlight","theme","enabled","connected","palette","info","main","success","error","mqttStatus","disconnectReason","disconnect_reason","TCP_DISCONNECTED","MQTT_UNACCEPTABLE_PROTOCOL_VERSION","MQTT_IDENTIFIER_REJECTED","MQTT_SERVER_UNAVAILABLE","MQTT_MALFORMED_CREDENTIALS","MQTT_NOT_AUTHORIZED","ESP8266_NOT_ENOUGH_SPACE","TLS_BAD_FINGERPRINT","MqttStatusForm","read","readMqttStatus","loadData","data","errorMessage","content","renderConnectionStatus","client_id","bgcolor"],"mappings":"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","sourcesContent":["import { FC } from \"react\";\n\nimport { Avatar, Button, Divider, List, ListItem, ListItemAvatar, ListItemText, Theme, useTheme } from \"@mui/material\";\nimport DeviceHubIcon from '@mui/icons-material/DeviceHub';\nimport RefreshIcon from '@mui/icons-material/Refresh';\nimport ReportIcon from '@mui/icons-material/Report';\n\nimport * as MqttApi from \"../../api/mqtt\";\nimport { MqttStatus, MqttDisconnectReason } from \"../../types\";\nimport { ButtonRow, FormLoader, SectionContent } from \"../../components\";\nimport { useRest } from \"../../utils\";\n\nexport const mqttStatusHighlight = ({ enabled, connected }: MqttStatus, theme: Theme) => {\n  if (!enabled) {\n    return theme.palette.info.main;\n  }\n  if (connected) {\n    return theme.palette.success.main;\n  }\n  return theme.palette.error.main;\n};\n\nexport const mqttStatus = ({ enabled, connected }: MqttStatus) => {\n  if (!enabled) {\n    return \"Not enabled\";\n  }\n  if (connected) {\n    return \"Connected\";\n  }\n  return \"Disconnected\";\n};\n\nexport const disconnectReason = ({ disconnect_reason }: MqttStatus) => {\n  switch (disconnect_reason) {\n    case MqttDisconnectReason.TCP_DISCONNECTED:\n      return \"TCP disconnected\";\n    case MqttDisconnectReason.MQTT_UNACCEPTABLE_PROTOCOL_VERSION:\n      return \"Unacceptable protocol version\";\n    case MqttDisconnectReason.MQTT_IDENTIFIER_REJECTED:\n      return \"Client ID rejected\";\n    case MqttDisconnectReason.MQTT_SERVER_UNAVAILABLE:\n      return \"Server unavailable\";\n    case MqttDisconnectReason.MQTT_MALFORMED_CREDENTIALS:\n      return \"Malformed credentials\";\n    case MqttDisconnectReason.MQTT_NOT_AUTHORIZED:\n      return \"Not authorized\";\n    case MqttDisconnectReason.ESP8266_NOT_ENOUGH_SPACE:\n      return \"Device out of memory\";\n    case MqttDisconnectReason.TLS_BAD_FINGERPRINT:\n      return \"Server fingerprint invalid\";\n    default:\n      return \"Unknown\";\n  }\n};\n\nconst MqttStatusForm: FC = () => {\n  const { loadData, data, errorMessage } = useRest<MqttStatus>({ read: MqttApi.readMqttStatus });\n\n  const theme = useTheme();\n\n  const content = () => {\n    if (!data) {\n      return (<FormLoader onRetry={loadData} errorMessage={errorMessage} />);\n    }\n\n    const renderConnectionStatus = () => {\n      if (data.connected) {\n        return (\n          <>\n            <ListItem>\n              <ListItemAvatar>\n                <Avatar>#</Avatar>\n              </ListItemAvatar>\n              <ListItemText primary=\"Client ID\" secondary={data.client_id} />\n            </ListItem>\n            <Divider variant=\"inset\" component=\"li\" />\n          </>\n        );\n      }\n      return (\n        <>\n          <ListItem>\n            <ListItemAvatar>\n              <Avatar>\n                <ReportIcon />\n              </Avatar>\n            </ListItemAvatar>\n            <ListItemText primary=\"Disconnect Reason\" secondary={disconnectReason(data)} />\n          </ListItem>\n          <Divider variant=\"inset\" component=\"li\" />\n        </>\n      );\n    };\n\n    return (\n      <>\n        <List>\n          <ListItem>\n            <ListItemAvatar>\n              <Avatar sx={{ bgcolor: mqttStatusHighlight(data, theme) }}>\n                <DeviceHubIcon />\n              </Avatar>\n            </ListItemAvatar>\n            <ListItemText primary=\"Status\" secondary={mqttStatus(data)} />\n          </ListItem>\n          <Divider variant=\"inset\" component=\"li\" />\n          {data.enabled && renderConnectionStatus()}\n        </List >\n        <ButtonRow pt={1}>\n          <Button startIcon={<RefreshIcon />} variant=\"contained\" color=\"secondary\" onClick={loadData}>\n            Refresh\n          </Button>\n        </ButtonRow>\n      </>\n    );\n  };\n\n  return (\n    <SectionContent title='MQTT Status' titleGutter>\n      {content()}\n    </SectionContent>\n  );\n\n};\n\nexport default MqttStatusForm;\n"]},"metadata":{},"sourceType":"module"}