{"ast":null,"code":"import _asyncToGenerator from\"/home/brent/Documents/PlatformIO/Projects/ESP32_C3_Test/interface/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/brent/Documents/PlatformIO/Projects/ESP32_C3_Test/interface/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/home/brent/Documents/PlatformIO/Projects/ESP32_C3_Test/interface/node_modules/@babel/runtime/regenerator/index.js\";import{useState}from\"react\";import{Button}from\"@mui/material\";import SaveIcon from'@mui/icons-material/Save';import{ButtonRow,FormLoader,MessageBox,SectionContent,ValidatedTextField}from\"../components\";import{validate}from\"../validators\";import{useRest,updateValue}from\"../utils\";import*as DemoApi from'./api';import{LIGHT_MQTT_SETTINGS_VALIDATOR}from\"./validators\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var LightMqttSettingsForm=function LightMqttSettingsForm(){var _useState=useState(),_useState2=_slicedToArray(_useState,2),fieldErrors=_useState2[0],setFieldErrors=_useState2[1];var _useRest=useRest({read:DemoApi.readBrokerSettings,update:DemoApi.updateBrokerSettings}),loadData=_useRest.loadData,saveData=_useRest.saveData,saving=_useRest.saving,setData=_useRest.setData,data=_useRest.data,errorMessage=_useRest.errorMessage;var updateFormValue=updateValue(setData);var content=function content(){if(!data){return/*#__PURE__*/_jsx(FormLoader,{onRetry:loadData,errorMessage:errorMessage});}var validateAndSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;setFieldErrors(undefined);_context.next=4;return validate(LIGHT_MQTT_SETTINGS_VALIDATOR,data);case 4:saveData();_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);setFieldErrors(_context.t0);case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function validateAndSubmit(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(MessageBox,{level:\"info\",message:\"The LED is controllable via MQTT with the demo project designed to work with Home Assistant's auto discovery feature.\",my:2}),/*#__PURE__*/_jsx(ValidatedTextField,{fieldErrors:fieldErrors,name:\"unique_id\",label:\"Unique ID\",fullWidth:true,variant:\"outlined\",value:data.unique_id,onChange:updateFormValue,margin:\"normal\"}),/*#__PURE__*/_jsx(ValidatedTextField,{fieldErrors:fieldErrors,name:\"name\",label:\"Name\",fullWidth:true,variant:\"outlined\",value:data.name,onChange:updateFormValue,margin:\"normal\"}),/*#__PURE__*/_jsx(ValidatedTextField,{fieldErrors:fieldErrors,name:\"mqtt_path\",label:\"MQTT Path\",fullWidth:true,variant:\"outlined\",value:data.mqtt_path,onChange:updateFormValue,margin:\"normal\"}),/*#__PURE__*/_jsx(ButtonRow,{mt:1,children:/*#__PURE__*/_jsx(Button,{startIcon:/*#__PURE__*/_jsx(SaveIcon,{}),disabled:saving,variant:\"contained\",color:\"primary\",type:\"submit\",onClick:validateAndSubmit,children:\"Save\"})})]});};return/*#__PURE__*/_jsx(SectionContent,{title:\"MQTT Settings\",titleGutter:true,children:content()});};export default LightMqttSettingsForm;","map":{"version":3,"sources":["/home/brent/Documents/PlatformIO/Projects/ESP32_C3_Test/interface/src/project/LightMqttSettingsForm.tsx"],"names":["useState","Button","SaveIcon","ButtonRow","FormLoader","MessageBox","SectionContent","ValidatedTextField","validate","useRest","updateValue","DemoApi","LIGHT_MQTT_SETTINGS_VALIDATOR","LightMqttSettingsForm","fieldErrors","setFieldErrors","read","readBrokerSettings","update","updateBrokerSettings","loadData","saveData","saving","setData","data","errorMessage","updateFormValue","content","validateAndSubmit","undefined","unique_id","name","mqtt_path"],"mappings":"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","sourcesContent":["import { FC, useState } from \"react\";\nimport { ValidateFieldsError } from \"async-validator\";\n\nimport { Button } from \"@mui/material\";\nimport SaveIcon from '@mui/icons-material/Save';\n\nimport { ButtonRow, FormLoader, MessageBox, SectionContent, ValidatedTextField } from \"../components\";\nimport { validate } from \"../validators\";\nimport { useRest, updateValue } from \"../utils\";\n\nimport * as DemoApi from './api';\nimport { LightMqttSettings } from \"./types\";\nimport { LIGHT_MQTT_SETTINGS_VALIDATOR } from \"./validators\";\n\nconst LightMqttSettingsForm: FC = () => {\n  const [fieldErrors, setFieldErrors] = useState<ValidateFieldsError>();\n  const {\n    loadData, saveData, saving, setData, data, errorMessage\n  } = useRest<LightMqttSettings>({ read: DemoApi.readBrokerSettings, update: DemoApi.updateBrokerSettings });\n\n  const updateFormValue = updateValue(setData);\n\n  const content = () => {\n    if (!data) {\n      return (<FormLoader onRetry={loadData} errorMessage={errorMessage} />);\n    }\n\n    const validateAndSubmit = async () => {\n      try {\n        setFieldErrors(undefined);\n        await validate(LIGHT_MQTT_SETTINGS_VALIDATOR, data);\n        saveData();\n      } catch (errors: any) {\n        setFieldErrors(errors);\n      }\n    };\n\n    return (\n      <>\n        <MessageBox\n          level=\"info\"\n          message=\"The LED is controllable via MQTT with the demo project designed to work with Home Assistant's auto discovery feature.\"\n          my={2}\n        />\n        <ValidatedTextField\n          fieldErrors={fieldErrors}\n          name=\"unique_id\"\n          label=\"Unique ID\"\n          fullWidth\n          variant=\"outlined\"\n          value={data.unique_id}\n          onChange={updateFormValue}\n          margin=\"normal\"\n        />\n        <ValidatedTextField\n          fieldErrors={fieldErrors}\n          name=\"name\"\n          label=\"Name\"\n          fullWidth\n          variant=\"outlined\"\n          value={data.name}\n          onChange={updateFormValue}\n          margin=\"normal\"\n        />\n        <ValidatedTextField\n          fieldErrors={fieldErrors}\n          name=\"mqtt_path\"\n          label=\"MQTT Path\"\n          fullWidth\n          variant=\"outlined\"\n          value={data.mqtt_path}\n          onChange={updateFormValue}\n          margin=\"normal\"\n        />\n        <ButtonRow mt={1}>\n          <Button startIcon={<SaveIcon />} disabled={saving} variant=\"contained\" color=\"primary\" type=\"submit\" onClick={validateAndSubmit}>\n            Save\n          </Button>\n        </ButtonRow>\n      </>\n    );\n  };\n\n  return (\n    <SectionContent title='MQTT Settings' titleGutter>\n      {content()}\n    </SectionContent>\n  );\n};\n\nexport default LightMqttSettingsForm;\n"]},"metadata":{},"sourceType":"module"}