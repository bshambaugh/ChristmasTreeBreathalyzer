{"ast":null,"code":"import _asyncToGenerator from\"/home/brent/Documents/PlatformIO/Projects/ESP32_C3_Test/interface/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/brent/Documents/PlatformIO/Projects/ESP32_C3_Test/interface/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/home/brent/Documents/PlatformIO/Projects/ESP32_C3_Test/interface/node_modules/@babel/runtime/regenerator/index.js\";import{useState}from'react';import{Button,Checkbox}from'@mui/material';import SaveIcon from'@mui/icons-material/Save';import*as MqttApi from\"../../api/mqtt\";import{BlockFormControlLabel,ButtonRow,FormLoader,SectionContent,ValidatedPasswordField,ValidatedTextField}from'../../components';import{MQTT_SETTINGS_VALIDATOR,validate}from'../../validators';import{numberValue,updateValue,useRest}from'../../utils';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var MqttSettingsForm=function MqttSettingsForm(){var _useState=useState(),_useState2=_slicedToArray(_useState,2),fieldErrors=_useState2[0],setFieldErrors=_useState2[1];var _useRest=useRest({read:MqttApi.readMqttSettings,update:MqttApi.updateMqttSettings}),loadData=_useRest.loadData,saving=_useRest.saving,data=_useRest.data,setData=_useRest.setData,saveData=_useRest.saveData,errorMessage=_useRest.errorMessage;var updateFormValue=updateValue(setData);var content=function content(){if(!data){return/*#__PURE__*/_jsx(FormLoader,{onRetry:loadData,errorMessage:errorMessage});}var validateAndSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;setFieldErrors(undefined);_context.next=4;return validate(MQTT_SETTINGS_VALIDATOR,data);case 4:saveData();_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);setFieldErrors(_context.t0);case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function validateAndSubmit(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(BlockFormControlLabel,{control:/*#__PURE__*/_jsx(Checkbox,{name:\"enabled\",checked:data.enabled,onChange:updateFormValue}),label:\"Enable MQTT?\"}),/*#__PURE__*/_jsx(ValidatedTextField,{fieldErrors:fieldErrors,name:\"host\",label:\"Host\",fullWidth:true,variant:\"outlined\",value:data.host,onChange:updateFormValue,margin:\"normal\"}),/*#__PURE__*/_jsx(ValidatedTextField,{fieldErrors:fieldErrors,name:\"port\",label:\"Port\",fullWidth:true,variant:\"outlined\",value:numberValue(data.port),type:\"number\",onChange:updateFormValue,margin:\"normal\"}),/*#__PURE__*/_jsx(ValidatedTextField,{name:\"username\",label:\"Username\",fullWidth:true,variant:\"outlined\",value:data.username,onChange:updateFormValue,margin:\"normal\"}),/*#__PURE__*/_jsx(ValidatedPasswordField,{name:\"password\",label:\"Password\",fullWidth:true,variant:\"outlined\",value:data.password,onChange:updateFormValue,margin:\"normal\"}),/*#__PURE__*/_jsx(ValidatedTextField,{name:\"client_id\",label:\"Client ID (optional)\",fullWidth:true,variant:\"outlined\",value:data.client_id,onChange:updateFormValue,margin:\"normal\"}),/*#__PURE__*/_jsx(ValidatedTextField,{fieldErrors:fieldErrors,name:\"keep_alive\",label:\"Keep Alive (seconds)\",fullWidth:true,variant:\"outlined\",value:numberValue(data.keep_alive),type:\"number\",onChange:updateFormValue,margin:\"normal\"}),/*#__PURE__*/_jsx(BlockFormControlLabel,{control:/*#__PURE__*/_jsx(Checkbox,{name:\"clean_session\",checked:data.clean_session,onChange:updateFormValue}),label:\"Clean Session?\"}),/*#__PURE__*/_jsx(ValidatedTextField,{fieldErrors:fieldErrors,name:\"max_topic_length\",label:\"Max Topic Length\",fullWidth:true,variant:\"outlined\",value:numberValue(data.max_topic_length),type:\"number\",onChange:updateFormValue,margin:\"normal\"}),/*#__PURE__*/_jsx(ButtonRow,{mt:1,children:/*#__PURE__*/_jsx(Button,{startIcon:/*#__PURE__*/_jsx(SaveIcon,{}),disabled:saving,variant:\"contained\",color:\"primary\",type:\"submit\",onClick:validateAndSubmit,children:\"Save\"})})]});};return/*#__PURE__*/_jsx(SectionContent,{title:\"MQTT Settings\",titleGutter:true,children:content()});};export default MqttSettingsForm;","map":{"version":3,"sources":["/home/brent/Documents/PlatformIO/Projects/ESP32_C3_Test/interface/src/framework/mqtt/MqttSettingsForm.tsx"],"names":["useState","Button","Checkbox","SaveIcon","MqttApi","BlockFormControlLabel","ButtonRow","FormLoader","SectionContent","ValidatedPasswordField","ValidatedTextField","MQTT_SETTINGS_VALIDATOR","validate","numberValue","updateValue","useRest","MqttSettingsForm","fieldErrors","setFieldErrors","read","readMqttSettings","update","updateMqttSettings","loadData","saving","data","setData","saveData","errorMessage","updateFormValue","content","validateAndSubmit","undefined","enabled","host","port","username","password","client_id","keep_alive","clean_session","max_topic_length"],"mappings":"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","sourcesContent":["import { FC, useState } from 'react';\nimport { ValidateFieldsError } from 'async-validator';\n\nimport { Button, Checkbox } from '@mui/material';\nimport SaveIcon from '@mui/icons-material/Save';\n\nimport * as MqttApi from \"../../api/mqtt\";\nimport { MqttSettings } from '../../types';\nimport { BlockFormControlLabel, ButtonRow, FormLoader, SectionContent, ValidatedPasswordField, ValidatedTextField } from '../../components';\nimport { MQTT_SETTINGS_VALIDATOR, validate } from '../../validators';\nimport { numberValue, updateValue, useRest } from '../../utils';\n\nconst MqttSettingsForm: FC = () => {\n  const [fieldErrors, setFieldErrors] = useState<ValidateFieldsError>();\n  const {\n    loadData, saving, data, setData, saveData, errorMessage\n  } = useRest<MqttSettings>({ read: MqttApi.readMqttSettings, update: MqttApi.updateMqttSettings });\n\n  const updateFormValue = updateValue(setData);\n\n  const content = () => {\n    if (!data) {\n      return (<FormLoader onRetry={loadData} errorMessage={errorMessage} />);\n    }\n\n    const validateAndSubmit = async () => {\n      try {\n        setFieldErrors(undefined);\n        await validate(MQTT_SETTINGS_VALIDATOR, data);\n        saveData();\n      } catch (errors: any) {\n        setFieldErrors(errors);\n      }\n    };\n\n    return (\n      <>\n        <BlockFormControlLabel\n          control={\n            <Checkbox\n              name=\"enabled\"\n              checked={data.enabled}\n              onChange={updateFormValue}\n            />\n          }\n          label=\"Enable MQTT?\"\n        />\n        <ValidatedTextField\n          fieldErrors={fieldErrors}\n          name=\"host\"\n          label=\"Host\"\n          fullWidth\n          variant=\"outlined\"\n          value={data.host}\n          onChange={updateFormValue}\n          margin=\"normal\"\n        />\n        <ValidatedTextField\n          fieldErrors={fieldErrors}\n          name=\"port\"\n          label=\"Port\"\n          fullWidth\n          variant=\"outlined\"\n          value={numberValue(data.port)}\n          type=\"number\"\n          onChange={updateFormValue}\n          margin=\"normal\"\n        />\n        <ValidatedTextField\n          name=\"username\"\n          label=\"Username\"\n          fullWidth\n          variant=\"outlined\"\n          value={data.username}\n          onChange={updateFormValue}\n          margin=\"normal\"\n        />\n        <ValidatedPasswordField\n          name=\"password\"\n          label=\"Password\"\n          fullWidth\n          variant=\"outlined\"\n          value={data.password}\n          onChange={updateFormValue}\n          margin=\"normal\"\n        />\n        <ValidatedTextField\n          name=\"client_id\"\n          label=\"Client ID (optional)\"\n          fullWidth\n          variant=\"outlined\"\n          value={data.client_id}\n          onChange={updateFormValue}\n          margin=\"normal\"\n        />\n        <ValidatedTextField\n          fieldErrors={fieldErrors}\n          name=\"keep_alive\"\n          label=\"Keep Alive (seconds)\"\n          fullWidth\n          variant=\"outlined\"\n          value={numberValue(data.keep_alive)}\n          type=\"number\"\n          onChange={updateFormValue}\n          margin=\"normal\"\n        />\n        <BlockFormControlLabel\n          control={\n            <Checkbox\n              name=\"clean_session\"\n              checked={data.clean_session}\n              onChange={updateFormValue}\n            />\n          }\n          label=\"Clean Session?\"\n        />\n        <ValidatedTextField\n          fieldErrors={fieldErrors}\n          name=\"max_topic_length\"\n          label=\"Max Topic Length\"\n          fullWidth\n          variant=\"outlined\"\n          value={numberValue(data.max_topic_length)}\n          type=\"number\"\n          onChange={updateFormValue}\n          margin=\"normal\"\n        />\n        <ButtonRow mt={1}>\n          <Button startIcon={<SaveIcon />} disabled={saving} variant=\"contained\" color=\"primary\" type=\"submit\" onClick={validateAndSubmit}>\n            Save\n          </Button>\n        </ButtonRow>\n      </>\n    );\n  };\n\n  return (\n    <SectionContent title='MQTT Settings' titleGutter>\n      {content()}\n    </SectionContent>\n  );\n};\n\nexport default MqttSettingsForm;\n"]},"metadata":{},"sourceType":"module"}